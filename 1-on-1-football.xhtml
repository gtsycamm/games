<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <base target="_blank" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style type="text/css">
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        font-family: "Gill Sans", sans-serif;
        background: transparent;
      }
      .game-embed-container {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #274e13;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
        box-sizing: border-box;
        color: #fff;
        text-align: center;
      }
      .button-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 25px;
        padding: 20px;
        width: 100%;
        max-width: 550px;
        box-sizing: border-box;
      }
      .logo-text {
        font-family: "Gill Sans", sans-serif;
        font-size: 2.5rem;
        font-weight: bold;
        color: #fff;
        text-shadow: 2px 2px 5px rgba(0, 0, 0, .6);
        padding-bottom: 10px;
      }
      .button-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        width: 100%;
      }
      @media (max-width: 480px) {
        .button-grid {
          grid-template-columns: 1fr;
        }
        .logo-text {
          font-size: 2rem;
        }
      }
      .c-button {
        min-height: 50px;
        appearance: none;
        border: 2px solid rgba(0, 0, 0, .2);
        border-radius: 8px;
        color: #fff;
        padding: 10px 15px;
        font-size: 18px;
        cursor: pointer;
        transition: all .2s ease-in-out;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }
      .btn-primary {
        background: #6aa84f;
      }
      .btn-primary:hover {
        background: #8fbc8f;
        border-color: #a2d1a2;
        transform: translateY(-2px);
      }
      .btn-alt {
        background: #073763;
      }
      .btn-alt:hover {
        background: #3d85c6;
        border-color: #6f9ac4;
        transform: translateY(-2px);
      }
      .c-button:focus {
        outline: none;
        box-shadow: 0 0 0 4px #cbd6ee;
      }
      .c-button:disabled {
        background: #555;
        cursor: not-allowed;
      }
      .game-embed-container iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
    </style>
  </head>
  <body>
    <div id="gameContainer" class="game-embed-container">
      <div id="buttonWrapper" class="button-wrapper">
        <div class="logo-text">CLASSROOM 6X</div>
        <div class="button-grid">
          <button id="playPrimaryInline" class="c-button btn-primary">PLAY HERE</button>
          <button id="playPrimaryFullscreen" class="c-button btn-primary">FULLSCREEN</button>
          <button id="playAltInline" class="c-button btn-alt">PLAY HERE (Alt)</button>
          <button id="playAltFullscreen" class="c-button btn-alt">FULLSCREEN (Alt)</button>
        </div>
      </div>
    </div>
    <script type="text/javascript">
      const gameContainer=document.getElementById("gameContainer"),
      buttonWrapper=document.getElementById("buttonWrapper"),
      googleScriptUrl="https://script.google.com/macros/s/AKfycbwDQPy94m3iDQqxeBLkyAH8rWoNeunk0TyuS7j5qE6hSk3o3j6eoU7z5uy_qhgsKeKn/exec",
      gameXmlUrl="data:@file/xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGlu...",
      faviconUrl="https://ssl.gstatic.com/classroom/favicon.png",
      pageTitle="classroom.google.com",
      playPrimaryInlineBtn=document.getElementById("playPrimaryInline"),
      playPrimaryFullscreenBtn=document.getElementById("playPrimaryFullscreen");

      playPrimaryInlineBtn.addEventListener("click", function() {
        gameContainer.innerHTML="";
        const e=document.createElement("iframe");
        e.src=googleScriptUrl;
        gameContainer.appendChild(e);
      });

      playPrimaryFullscreenBtn.addEventListener("click", function() {
        const e=window.open("","_blank");
        if(e){
          e.document.write(
            "<!DOCTYPE html><html><head><title>"+pageTitle+"</title><link rel='icon' href='"+faviconUrl+"' />"+
            "<style>body,html{margin:0;padding:0;height:100%;width:100%;overflow:hidden;}iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:none;}</style>"+
            "</head><body><iframe src='"+googleScriptUrl+"' allowfullscreen='allowfullscreen'></iframe></body></html>"
          );
        }
      });

      const playAltInlineBtn=document.getElementById("playAltInline"),
      playAltFullscreenBtn=document.getElementById("playAltFullscreen");
      let readyHtmlContent=null;

      async function prepareGameContent(){
        try{
          const e=await fetch(gameXmlUrl);
          if(!e.ok)throw new Error("Failed to load XML: "+e.status+" "+e.statusText);
          const t=await e.text(),n=new DOMParser(),o=n.parseFromString(t,"application/xml"),
          r=o.querySelector("Content");
          if(!r)throw new Error("&lt;Content&gt; not found in XML");
          const a=r.textContent,d=n.parseFromString(a,"text/html");
          if(!d.head){
            const c=d.createElement("head");
            d.documentElement.insertBefore(c,d.documentElement.firstChild);
          }
          let i=d.querySelector("title");
          if(!i){i=d.createElement("title");d.head.appendChild(i);}
          i.textContent=pageTitle;
          const l=d.createElement("link");
          l.rel="icon";
          l.href=faviconUrl;
          d.head.appendChild(l);
          const styleReset=d.createElement("style");
          styleReset.textContent="html,body,#container{margin:0;padding:0;width:100%!important;height:100%!important;overflow:hidden!important}";
          d.head.appendChild(styleReset);
          let s;
          s="data:"===gameXmlUrl.substring(0,5)?window.location.href:gameXmlUrl.substring(0,gameXmlUrl.lastIndexOf("/")+1);
          const u=d.createElement("base");
          u.href=s;
          d.head.prepend(u);
          const p=JSON.stringify(window.location.hostname),
          g=JSON.stringify(window.location.href),
          m=d.createElement("script");
          m.textContent="(function(){ /* code omitted for brevity */ })();";
          d.head.prepend(m);
          readyHtmlContent=d.documentElement.outerHTML;
        }catch(err){
          gameContainer.innerHTML="<div style='color:red;padding:20px;'>Error: "+err.message+"</div>";
          playAltInlineBtn.disabled=true;
          playAltFullscreenBtn.disabled=true;
        }
      }

      prepareGameContent();

      function launchAltGame(isInline){
        if(!readyHtmlContent){alert("Game is not ready yet. Please wait.");return;}
        const e=new Blob([readyHtmlContent],{type:"text/html"}),t=URL.createObjectURL(e);
        if(isInline){
          gameContainer.innerHTML="";
          const n=document.createElement("iframe");
          n.src=t;
          n.allow="fullscreen; autoplay; encrypted-media";
          n.style.width="100%";
          n.style.height="100%";
          gameContainer.appendChild(n);
        }else{
          const o=window.open(t,"_blank");
          if(!o)alert("Please allow popups for this site.");
        }
      }

      playAltInlineBtn.addEventListener("click", function(){launchAltGame(true);});
      playAltFullscreenBtn.addEventListener("click", function(){launchAltGame(false);});
    </script>
  </body>
</html>
